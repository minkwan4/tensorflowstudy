# -*- coding: utf-8 -*-
"""COLAB_TEST4(심화1).ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1mZEN01AVt2TwZeTdbaHSovCLRsMwv72c
"""

import tensorflow as tf
from tensorflow import keras
print(tf.__version__)

#dataset 구성 : mnist 데이터 셋
mnist = keras.datasets.mnist
(x_train, y_train), (x_test, y_test) = mnist.load_data()
x_train, x_test = x_train/255, x_test/255

#모델구성(or모델선언)
model = keras.Sequential() #Sequential을 먼저 선언
model.add(keras.layers.Flatten(input_shape=(28,28))) #Flatten을 통해 28x28(이미지)형태의 Dense 벡터로 모델변환모델구성
# 궁금증 -> input_shape를 무조건 선언해줘야 하나요? -> model.summary()를 통해 파라미터 개수를 계산 하려면, input_shaep()가 필요!!!
model.add(keras.layers.Dense(128, activation='relu')) #Dense layer를 통해 128차원으로 압축
model.add(keras.layers.Dropout(0,3)) #Dropout을 활용하여, 로드를 꺼트린다.
model.add(keras.layers.Dense(10,activation='softmax')) # 마지막 Dense층은 10(0~9)개로 만든다.

model.summary()

#모델 학습에 필요한 정보 넣기 <- 보내
model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])

from sklearn.preprocessing import StandardScaler
scaler=StandardScaler()
X_train=scaler.fit_transform(x_train)
X_test=scaler.fit_transform(x_test)

#모델 학습 시키기 <-여기에서 에러발생 
model.fit(x_train, y_train, epochs=5)
model.evaluate(x_test, y_test, verbose=2)

